# Product Requirements Document (PRD): Toshik Babe Engine

**Версия:** 1.0  
**Дата:** 8 февраля 2026 г.  
**Статус:** Черновик  

## 1. Обзор и цели продукта (Product Goals)

**Видение:**  
Toshik Babe Engine — это суверенная система ИИ-ассистента, разработанная как более быстрая, приватная и глубоко интегрированная альтернатива существующим решениям (например, OpenClaw). Система ориентирована на полный контроль пользователя над данными, мгновенный отклик интерфейса и гибкость в выборе моделей.

**Ключевые проблемы, которые мы решаем:**
*   **Приватность:** Исключение посредников в обработке данных. Все, что может быть обработано локально или на личном VPS, должно обрабатываться там.
*   **Скорость:** Минимизация задержек (latency) за счет использования Bun и оптимизированных WebSocket-соединений. Ощущение "нативности" и мгновенности.
*   **Кастомные интеграции:** Глубокая интеграция с операционной системой и рабочими процессами пользователя, не ограниченная "песочницей" браузера.

## 2. Функциональные требования (Functional Requirements)

### 2.1. Коммуникация и Ядро
*   **High-speed WebSocket Communication:** Реализация двунаправленного протокола связи между клиентом (Tauri) и сервером (Bun) через WebSocket для стриминга токенов и обновлений состояния в реальном времени.
*   **Менеджер сессий:** Поддержка persistent-соединений с возможностью восстановления контекста при обрыве связи.

### 2.2. Мультимодальность
*   **Текст:** Поддержка Markdown, LaTeX, подсветки синтаксиса кода.
*   **Vision (Зрение):** Возможность отправки скриншотов, изображений из буфера обмена и файлов для анализа моделью.
*   **Файлы:** Загрузка, индексация и анализ текстовых документов (PDF, TXT, MD, Code).

### 2.3. Система памяти (Local-first Memory)
*   **SQLite:** Хранение истории чатов, настроек и структурированных данных (метаданные файлов, логи).
*   **Vector RAG (Retrieval-Augmented Generation):** Локальная векторная база данных (например, интеграция с SQLite-vss или легковесное решение на базе LanceDB) для семантического поиска по истории и документам.

### 2.4. Динамический интерфейс (Dynamic UI)
*   **Двухзонная компоновка:**
    *   **Зона Чата:** Классический интерфейс диалога.
    *   **Зона Контекста (Context Widgets):** Динамическая панель справа, отображающая релевантную информацию (код, предпросмотр ссылок, статус задач, RAG-выборку) без загромождения основного чата.

### 2.5. Библиотека промптов (Prompt Template Library)
*   Система управления системными промптами и шаблонами ("Персоны").
*   Поддержка переменных (например, `{{selection}}`, `{{clipboard}}`) для быстрой вставки контекста.

## 3. Нефункциональные требования (Non-Functional Requirements)

### 3.1. Производительность
*   **Latency:** Время отклика UI (Time to First Byte / отрисовка) < 100 мс.
*   **Ресурсоэффективность:** Бэкенд на Bun должен потреблять минимальное количество RAM (< 150 МБ в простое) для комфортной работы на бюджетных VPS (например, Beget, тарифы с 1-2 vCPU).

### 3.2. Безопасность
*   **E2E Encryption:** Шифрование данных при синхронизации между клиентом и сервером (если сервер удаленный).
*   **Local Ownership:** Полный отказ от телеметрии третьих сторон. База данных хранится локально или на контролируемом пользователем VPS.

### 3.3. Надежность
*   Graceful degradation: При отсутствии сети доступ к локальной истории и поиску должен сохраняться.

## 4. Принципы UX (User Experience Principles)

*   **Минимализм (Minimalism):** Интерфейс не должен отвлекать от контента. Использование чистого дизайна, отсутствие визуального шума.
*   **Нулевое отвлечение (Zero-Distraction):** Уведомления и виджеты появляются только тогда, когда они действительно нужны. Режим "Focus Mode".
*   **Контекстная осведомленность (Context-awareness):** Система должна понимать, над чем работает пользователь (активное окно, выделенный текст) и предлагать релевантные действия.

## 5. Перспективы развития и будущее (Future-Proofing 2026+)

### 5.1. Агностицизм моделей (Model Agnostic Layer)
*   Архитектура должна поддерживать "горячую" замену провайдеров (OpenAI, Anthropic, Google, Local LLMs via Ollama/Llama.cpp).
*   Абстракция API-слоя для быстрой интеграции новых архитектур моделей, которые появятся в 2026 году и позже (например, агентные модели, модели с бесконечным контекстом).

### 5.2. Автономные агенты
*   Закладка фундамента для запуска фоновых sub-agents, способных выполнять долгосрочные задачи без активного окна чата.

### 5.3. Плагинная архитектура
*   Возможность расширения функционала сообществом (плагины на JavaScript/TypeScript, исполняемые в безопасной среде Bun).
